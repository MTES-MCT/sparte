{% extends "index.html" %}

{% load static %}
{% load project_tags %}
{% load humanize %}
{% load i18n %}
{% load l10n %}
{% load sri %}

{% block pagetitle %}
Zonages d'urbanisme
{% endblock pagetitle %}

{% block content %}
<div class="px-4">
    {% include "project/partials/report_title.html" with title=diagnostic surface=diagnostic.area %}

    {% include "project/report_menu.html" %}

    <div class="fr-container fr-py-3w">
        <div class="fr-callout fr-fi-information-line">
            <h3 class="fr-callout__title">Découvrez notre explorateur des zonages d'urbanisme</h3>
            <p class="fr-callout__text">
                Croisez les zonages d'urbanisme avec les données de l'OCS GE afin de comprendre l'artificialisation de votre territoire.
            </p>
            <a href="{% url 'project:map-urban-zones' project.pk %}">
                <button class="fr-btn">
                    Explorer les zonages d'urbanisme
                </button>
            </a>
        </div>
    

        <div class="fr-mt-7w" hx-get="{% url 'project:synthesis-zone-urba-all' project.id %}" hx-trigger="load delay 2s" hx-swap="outerHTML">
            <h3>Synthèses des zonages d'urbanime</h3>

            <!-- TODO Sofian ajouter skeletton -->
            <div class="fr-custom-loader"></div>
        </div>

        <div id="a123" class="fr-mt-7w" hx-get="{% url 'project:zone-urba-auu' project.id %}" hx-trigger="load delay 4s" hx-swap="outerHTML">
            <h3>Synthèses des zonages d'urbanime</h3>

            <!-- TODO Sofian ajouter skeletton -->
            <div class="fr-custom-loader"></div>
            <button class="fr-btn" hx-target="#a123" hx-swap="outerHTML" hx-get="{% url 'project:zone-urba-auu' project.id %}">reload</button>
        </div>

    </div>

</div>
{% endblock content %}

{% block tagging %}
<script language="javascript" nonce="{{ CSP_NONCE }}">
$( window ).on('load', function () {
    _paq.push(['trackEvent', 'Consultation diagnostic', 'Tableau de bord', 'Zonages d\'urbanisme'])
})

var fired = false
$( window ).scroll(function() {
    if(fired == false && $( window ).scrollTop() + $( window ).height() > $( "#block-content" ).height() - 100) {
        _paq.push(['trackEvent', 'Consultation diagnostic', 'Fin tableau de bord', 'Zonages d\'urbanisme']])
        fired = true
    }
})
</script>
{% endblock tagging %}
