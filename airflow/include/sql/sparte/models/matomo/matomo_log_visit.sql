{{
    config(
        materialized="table",
        indexes=[
            {"columns": ["user_id"], "type": "btree"},
            {"columns": ["visitor_count_visits"], "type": "btree"},
        ]
    )
}}

SELECt
    idvisit,
    idsite,
    idvisitor,
    visit_last_action_time,
    config_id,
    location_ip,
    profilable,
    user_id,
    visit_first_action_time,
    visit_goal_buyer,
    visit_goal_converted,
    visitor_returning,
    visitor_seconds_since_first,
    visitor_seconds_since_order,
    visitor_count_visits,
    visit_entry_idaction_name,
    visit_entry_idaction_url,
    visit_exit_idaction_name,
    visit_exit_idaction_url,
    visit_total_actions,
    visit_total_interactions,
    visit_total_searches,
    referer_keyword,
    referer_name,
    referer_type,
    referer_url,
    location_browser_lang,
    config_browser_engine,
    config_browser_name,
    config_browser_version,
    config_client_type,
    config_device_brand,
    config_device_model,
    config_device_type,
    config_os,
    config_os_version,
    visit_total_events,
    visitor_localtime,
    visitor_seconds_since_last,
    config_resolution,
    config_cookie,
    config_flash,
    config_java,
    config_pdf,
    config_quicktime,
    config_realplayer,
    config_silverlight,
    config_windowsmedia,
    visit_total_time,
    location_city,
    location_country,
    location_latitude,
    location_longitude,
    location_region,
    last_idlink_va,
    custom_dimension_1,
    custom_dimension_2,
    custom_dimension_3,
    custom_dimension_4,
    custom_dimension_5
FROM {{ source("public", "matomo_log_visit") }}
