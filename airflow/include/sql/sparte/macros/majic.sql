
{% macro majic(source_table_name) %}
    {{ config(materialized='table') }}

    SELECT
        idcom as commune_code,
        idcomtxt as commune_name,
        idreg as region_code,
        idregtxt as region_name,
        iddep as departement_code,
        iddeptxt as departement_name,
        epci23 as epci_code,
        epci23txt as epci_name,
        scot as scot_name,
        aav2020 as aire_attraction_ville,
        aav2020txt as tranche_aire_attraction_ville,
        aav2020_ty as typologie_aire_attraction_ville,
        naf09art10 as conso_2009_2010,
        art09act10 as conso_2009_2010_activite,
        art09hab10 as conso_2009_2010_habitat,
        art09mix10 as conso_2009_2010_mixte,
        art09rou10 as conso_2009_2010_route,
        art09fer10 as conso_2009_2010_ferroviaire,
        art09inc10 as conso_2009_2010_inconnu,
        naf10art11 as conso_2010_2011,
        art10act11 as conso_2010_2011_activite,
        art10hab11 as conso_2010_2011_habitat,
        art10mix11 as conso_2010_2011_mixte,
        art10rou11 as conso_2010_2011_route,
        art10fer11 as conso_2010_2011_ferroviaire,
        art10inc11 as conso_2010_2011_inconnu,
        naf11art12 as conso_2011_2012,
        art11act12 as conso_2011_2012_activite,
        art11hab12 as conso_2011_2012_habitat,
        art11mix12 as conso_2011_2012_mixte,
        art11rou12 as conso_2011_2012_route,
        art11fer12 as conso_2011_2012_ferroviaire,
        art11inc12 as conso_2011_2012_inconnu,
        naf12art13 as conso_2012_2013,
        art12act13 as conso_2012_2013_activite,
        art12hab13 as conso_2012_2013_habitat,
        art12mix13 as conso_2012_2013_mixte,
        art12rou13 as conso_2012_2013_route,
        art12fer13 as conso_2012_2013_ferroviaire,
        art12inc13 as conso_2012_2013_inconnu,
        naf13art14 as conso_2013_2014,
        art13act14 as conso_2013_2014_activite,
        art13hab14 as conso_2013_2014_habitat,
        art13mix14 as conso_2013_2014_mixte,
        art13rou14 as conso_2013_2014_route,
        art13fer14 as conso_2013_2014_ferroviaire,
        art13inc14 as conso_2013_2014_inconnu,
        naf14art15 as conso_2014_2015,
        art14act15 as conso_2014_2015_activite,
        art14hab15 as conso_2014_2015_habitat,
        art14mix15 as conso_2014_2015_mixte,
        art14rou15 as conso_2014_2015_route,
        art14fer15 as conso_2014_2015_ferroviaire,
        art14inc15 as conso_2014_2015_inconnu,
        naf15art16 as conso_2015_2016,
        art15act16 as conso_2015_2016_activite,
        art15hab16 as conso_2015_2016_habitat,
        art15mix16 as conso_2015_2016_mixte,
        art15rou16 as conso_2015_2016_route,
        art15fer16 as conso_2015_2016_ferroviaire,
        art15inc16 as conso_2015_2016_inconnu,
        naf16art17 as conso_2016_2017,
        art16act17 as conso_2016_2017_activite,
        art16hab17 as conso_2016_2017_habitat,
        art16mix17 as conso_2016_2017_mixte,
        art16rou17 as conso_2016_2017_route,
        art16fer17 as conso_2016_2017_ferroviaire,
        art16inc17 as conso_2016_2017_inconnu,
        naf17art18 as conso_2017_2018,
        art17act18 as conso_2017_2018_activite,
        art17hab18 as conso_2017_2018_habitat,
        art17mix18 as conso_2017_2018_mixte,
        art17rou18 as conso_2017_2018_route,
        art17fer18 as conso_2017_2018_ferroviaire,
        art17inc18 as conso_2017_2018_inconnu,
        naf18art19 as conso_2018_2019,
        art18act19 as conso_2018_2019_activite,
        art18hab19 as conso_2018_2019_habitat,
        art18mix19 as conso_2018_2019_mixte,
        art18rou19 as conso_2018_2019_route,
        art18fer19 as conso_2018_2019_ferroviaire,
        art18inc19 as conso_2018_2019_inconnu,
        naf19art20 as conso_2019_2020,
        art19act20 as conso_2019_2020_activite,
        art19hab20 as conso_2019_2020_habitat,
        art19mix20 as conso_2019_2020_mixte,
        art19rou20 as conso_2019_2020_route,
        art19fer20 as conso_2019_2020_ferroviaire,
        art19inc20 as conso_2019_2020_inconnu,
        naf20art21 as conso_2020_2021,
        art20act21 as conso_2020_2021_activite,
        art20hab21 as conso_2020_2021_habitat,
        art20mix21 as conso_2020_2021_mixte,
        art20rou21 as conso_2020_2021_route,
        art20fer21 as conso_2020_2021_ferroviaire,
        art20inc21 as conso_2020_2021_inconnu,
        naf21art22 as conso_2021_2022,
        art21act22 as conso_2021_2022_activite,
        art21hab22 as conso_2021_2022_habitat,
        art21mix22 as conso_2021_2022_mixte,
        art21rou22 as conso_2021_2022_route,
        art21fer22 as conso_2021_2022_ferroviaire,
        art21inc22 as conso_2021_2022_inconnu,
        naf22art23 as conso_2022_2023,
        art22act23 as conso_2022_2023_activite,
        art22hab23 as conso_2022_2023_habitat,
        art22mix23 as conso_2022_2023_mixte,
        art22rou23 as conso_2022_2023_route,
        art22fer23 as conso_2022_2023_ferroviaire,
        art22inc23 as conso_2022_2023_inconnu,
        naf09art23 as conso_2009_2023,
        art09act23 as conso_2009_2023_activite,
        art09hab23 as conso_2009_2023_habitat,
        art09mix23 as conso_2009_2023_mixte,
        art09rou23 as conso_2009_2023_route,
        art09fer23 as conso_2009_2023_ferroviaire,
        art09inc23 as conso_2009_2023_inconnu,
        pop14 as population_2014,
        pop20 as population_2020,
        pop1420 as population_variation_2014_2020,
        men14 as menages_2014,
        men20 as menages_2020,
        men1420 as menages_variation_2014_2020,
        emp14 as emplois_2014,
        emp20 as emplois_2020,
        emp1420 as emplois_variation_2014_2020,
        mepart1420 as nouveaux_menages_et_emplois_par_ha_2014_2020, -- Nombre de ménages + emplois supplémentaire par ha artificialisé (période 2014-2020). Égal à (men1420 + emp1420) / (naf14art20/10000)
        menhab1420 as nouveaux_menages_par_ha_consomme_pour_habitat_2014_2020, -- Nombre de ménages par ha artificialisé à destination de l’habitat (période 2014-2020). Égal à men1420 / (art14hab20 / 10000)
        artpop1420 as metre_carre_consomme_par_nouveau_habitant_2014_2020, -- Nombre de m² artificialisé par habitant supplémentaire (période 2014-2020). Égal à naf14art20 / pop1420
        surfcom202 as surface_commune_metre_carre_2020,
        geom
    FROM
        {{ source('public', source_table_name) }}
{% endmacro %}
