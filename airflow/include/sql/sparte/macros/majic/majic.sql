
{% macro majic(source_table_name, from_year, to_year) %}
    {{ config(materialized='table') }}

    SELECT
        idcom as commune_code,
        naf09art10::int as conso_2009,
        art09act10::int as conso_2009_activite,
        art09hab10::int as conso_2009_habitat,
        art09mix10::int as conso_2009_mixte,
        art09rou10::int as conso_2009_route,
        art09fer10::int as conso_2009_ferroviaire,
        art09inc10::int as conso_2009_inconnu,
        naf10art11::int as conso_2010,
        art10act11::int as conso_2010_activite,
        art10hab11::int as conso_2010_habitat,
        art10mix11::int as conso_2010_mixte,
        art10rou11::int as conso_2010_route,
        art10fer11::int as conso_2010_ferroviaire,
        art10inc11::int as conso_2010_inconnu,
        naf11art12::int as conso_2011,
        art11act12::int as conso_2011_activite,
        art11hab12::int as conso_2011_habitat,
        art11mix12::int as conso_2011_mixte,
        art11rou12::int as conso_2011_route,
        art11fer12::int as conso_2011_ferroviaire,
        art11inc12::int as conso_2011_inconnu,
        naf12art13::int as conso_2012,
        art12act13::int as conso_2012_activite,
        art12hab13::int as conso_2012_habitat,
        art12mix13::int as conso_2012_mixte,
        art12rou13::int as conso_2012_route,
        art12fer13::int as conso_2012_ferroviaire,
        art12inc13::int as conso_2012_inconnu,
        naf13art14::int as conso_2013,
        art13act14::int as conso_2013_activite,
        art13hab14::int as conso_2013_habitat,
        art13mix14::int as conso_2013_mixte,
        art13rou14::int as conso_2013_route,
        art13fer14::int as conso_2013_ferroviaire,
        art13inc14::int as conso_2013_inconnu,
        naf14art15::int as conso_2014,
        art14act15::int as conso_2014_activite,
        art14hab15::int as conso_2014_habitat,
        art14mix15::int as conso_2014_mixte,
        art14rou15::int as conso_2014_route,
        art14fer15::int as conso_2014_ferroviaire,
        art14inc15::int as conso_2014_inconnu,
        naf15art16::int as conso_2015,
        art15act16::int as conso_2015_activite,
        art15hab16::int as conso_2015_habitat,
        art15mix16::int as conso_2015_mixte,
        art15rou16::int as conso_2015_route,
        art15fer16::int as conso_2015_ferroviaire,
        art15inc16::int as conso_2015_inconnu,
        naf16art17::int as conso_2016,
        art16act17::int as conso_2016_activite,
        art16hab17::int as conso_2016_habitat,
        art16mix17::int as conso_2016_mixte,
        art16rou17::int as conso_2016_route,
        art16fer17::int as conso_2016_ferroviaire,
        art16inc17::int as conso_2016_inconnu,
        naf17art18::int as conso_2017,
        art17act18::int as conso_2017_activite,
        art17hab18::int as conso_2017_habitat,
        art17mix18::int as conso_2017_mixte,
        art17rou18::int as conso_2017_route,
        art17fer18::int as conso_2017_ferroviaire,
        art17inc18::int as conso_2017_inconnu,
        naf18art19::int as conso_2018,
        art18act19::int as conso_2018_activite,
        art18hab19::int as conso_2018_habitat,
        art18mix19::int as conso_2018_mixte,
        art18rou19::int as conso_2018_route,
        art18fer19::int as conso_2018_ferroviaire,
        art18inc19::int as conso_2018_inconnu,
        naf19art20::int as conso_2019,
        art19act20::int as conso_2019_activite,
        art19hab20::int as conso_2019_habitat,
        art19mix20::int as conso_2019_mixte,
        art19rou20::int as conso_2019_route,
        art19fer20::int as conso_2019_ferroviaire,
        art19inc20::int as conso_2019_inconnu,
        naf20art21::int as conso_2020,
        art20act21::int as conso_2020_activite,
        art20hab21::int as conso_2020_habitat,
        art20mix21::int as conso_2020_mixte,
        art20rou21::int as conso_2020_route,
        art20fer21::int as conso_2020_ferroviaire,
        art20inc21::int as conso_2020_inconnu,
        naf21art22::int as conso_2021,
        art21act22::int as conso_2021_activite,
        art21hab22::int as conso_2021_habitat,
        art21mix22::int as conso_2021_mixte,
        art21rou22::int as conso_2021_route,
        art21fer22::int as conso_2021_ferroviaire,
        art21inc22::int as conso_2021_inconnu,
        naf22art23::int as conso_2022,
        art22act23::int as conso_2022_activite,
        art22hab23::int as conso_2022_habitat,
        art22mix23::int as conso_2022_mixte,
        art22rou23::int as conso_2022_route,
        art22fer23::int as conso_2022_ferroviaire,
        art22inc23::int as conso_2022_inconnu,
        naf23art24::int as conso_2023,
        art23act24::int as conso_2023_activite,
        art23hab24::int as conso_2023_habitat,
        art23mix24::int as conso_2023_mixte,
        art23rou24::int as conso_2023_route,
        art23fer24::int as conso_2023_ferroviaire,
        art23inc24::int as conso_2023_inconnu,
        naf{{ from_year }}art{{ to_year }}::int as conso_20{{ from_year }}_20{{ to_year }},
        art{{ from_year }}act{{ to_year }}::int as conso_20{{ from_year }}_20{{ to_year }}_activite,
        art{{ from_year }}hab{{ to_year }}::int as conso_20{{ from_year }}_20{{ to_year }}_habitat,
        art{{ from_year }}mix{{ to_year }}::int as conso_20{{ from_year }}_20{{ to_year }}_mixte,
        art{{ from_year }}rou{{ to_year }}::int as conso_20{{ from_year }}_20{{ to_year }}_route,
        art{{ from_year }}fer{{ to_year }}::int as conso_20{{ from_year }}_20{{ to_year }}_ferroviaire,
        art{{ from_year }}inc{{ to_year }}::int as conso_20{{ from_year }}_20{{ to_year }}_inconnu
    FROM
        {{ source('public', source_table_name) }}
{% endmacro %}
